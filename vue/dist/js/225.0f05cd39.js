"use strict";(self["webpackChunkvue"]=self["webpackChunkvue"]||[]).push([[225],{1225:function(e,t,a){a.r(t),a.d(t,{default:function(){return p}});var r=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"search"},[t("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入教材名称"},model:{value:e.textbookName,callback:function(t){e.textbookName=t},expression:"textbookName"}}),t("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"info",plain:""},on:{click:function(t){return e.load(1)}}},[e._v("查询")]),t("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"warning",plain:""},on:{click:e.reset}},[e._v("重置")]),"TEACHER"===e.user.roleName||"MANAGER"===e.user.roleName?t("el-button",{attrs:{type:"primary",plain:""},on:{click:e.exportBatch}},[e._v("批量导出")]):e._e()],1),t("div",{staticClass:"operation"},["ADMIN"===e.user.roleName?t("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",plain:""},on:{click:e.handleAdd}},[e._v("新增")]):e._e(),"ADMIN"===e.user.roleName?t("el-button",{attrs:{type:"danger",plain:""},on:{click:e.delBatch}},[e._v("批量删除")]):e._e(),"ADMIN"===e.user.roleName?t("el-button",{attrs:{type:"success",plain:""},on:{click:e.eport}},[e._v("导入书单")]):e._e(),t("el-button",[t("el-switch",{staticStyle:{"margin-left":"10px"},attrs:{"active-text":"已通过"},on:{change:e.loadApproved},model:{value:e.ifApproved,callback:function(t){e.ifApproved=t},expression:"ifApproved"}})],1)],1),t("div",{staticClass:"table"},[t("el-table",{attrs:{data:e.tableData,stripe:""},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",idth:"55",align:"center"}}),t("el-table-column",{attrs:{prop:"orderFormId",label:"序号",align:"center",sortable:""}}),t("el-table-column",{attrs:{prop:"isbn",label:"ISBN号","show-overflow-tooltip":"",align:"center"}}),t("el-table-column",{attrs:{prop:"textbookName",label:"教材名称","show-overflow-tooltip":"",align:"center"}}),t("el-table-column",{attrs:{prop:"applicationNumber",label:"申请数量","show-overflow-tooltip":"",align:"center"}}),t("el-table-column",{attrs:{prop:"departmentName",label:"使用部门",align:"center"}}),t("el-table-column",{attrs:{prop:"applicationTime",label:"申请时间",align:"center"}}),t("el-table-column",{attrs:{prop:"realName",label:"申请人",align:"center"}}),t("el-table-column",{attrs:{prop:"applicationIllustration",label:"申请说明",align:"center"}}),t("el-table-column",{attrs:{prop:"replyMessage",label:"审批回复",align:"center"}}),t("el-table-column",{attrs:{prop:"applicationStatus",label:"审核状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return["1"===a.applicationStatus?t("span",[e._v("未审批")]):"2"===a.applicationStatus?t("span",[e._v("待教务处审批")]):"3"===a.applicationStatus?t("span",[e._v("已通过")]):t("span",[e._v("未通过")])]}}])}),t("el-table-column",{attrs:{width:"180",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return["3"===a.row.applicationStatus?t("el-button",{attrs:{type:"primary",plain:"true",size:"small"},on:{click:function(t){return e.downLoad(a.row)}}},[e._v("下载")]):t("span",[e._v("无法操作")])]}}])})],1),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{background:"","current-page":e.pageNum,"page-sizes":[1,10,20],"page-size":e.pageSize,layout:"total, prev, pager, next",total:e.total},on:{"current-change":e.handleCurrentChange}})],1)],1)])},o=[],l={name:"ApplicationProcessed",data(){return{ifApproved:!1,tableData:[],pageNum:1,pageSize:10,total:0,orderForm:{},form:{},user:JSON.parse(localStorage.getItem("xm-user")||"{}"),orderFormDate:[],textbookName:null,applicationStatus:null,orderFormIds:[],orderFormSelected:[]}},created(){this.load(1),this.loadOrderForm()},methods:{loadOrderForm(){this.$request.get("/orderForm/selectAll").then((e=>{"200"===e.code?this.orderFormDate=e.data:this.$message.error(e,msg)}))},load(e){e&&(this.pageNum=e),this.$request.get("/orderForm/selectPage",{params:{pageNum:this.pageNum,pageSize:this.pageSize,textbookName:this.textbookName,applicationStatus:this.applicationStatus,applicantId:this.user.userId}}).then((e=>{this.tableData=e.data?.list,this.total=e.data?.total,this.tableData=this.tableData.filter((e=>"3"===e.applicationStatus||"4"===e.applicationStatus))}))},loadApproved(){!0===this.ifApproved?(this.applicationStatus="3",this.load(1)):(this.applicationStatus=null,this.load(1))},downLoad(e){window.open(this.$baseUrl+"/orderForm/exportOne?token="+this.user.token+"&orderFormId="+e.orderFormId)},saveOrder(){this.$refs["orderFormRef"].validate((e=>{e&&this.$request.post("/orderForm/addOrderForm",this.orderForm).then((e=>{"200"===e.code?(this.$message.success("征订成功"),this.orderVisible=!1):this.$message.error(e.msg)}))}))},handleSelectionChange(e){this.orderFormIds=e.map((e=>e.orderFormId)),this.orderFormSelected=e.map((e=>e))},exportBatch(){if(!this.orderFormIds.length)return void this.$message.warning("请选择数据");for(let t=0;t<this.orderFormSelected.length;t++)if("4"===this.orderFormSelected[t].applicationStatus)return void this.$message.warning("存在未通过的申请");let e=this.orderFormIds.join(",");window.open(this.$baseUrl+"/orderForm/exportBatch?token="+this.user.token+"&orderFormIdList="+e)},reset(){this.textbookName=null,this.load(1)},handleCurrentChange(e){this.load(e)},handleBookCoverSuccess(e,t,a){this.form.bookCover=e.data}}},s=l,i=a(3736),n=(0,i.Z)(s,r,o,!1,null,"5da8f6f9",null),p=n.exports}}]);
//# sourceMappingURL=225.0f05cd39.js.map