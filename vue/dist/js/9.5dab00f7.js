"use strict";(self["webpackChunkvue"]=self["webpackChunkvue"]||[]).push([[9],{9009:function(e,t,a){a.r(t),a.d(t,{default:function(){return u}});var s=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"search"},[t("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入用户名"},model:{value:e.queryCondition.username,callback:function(t){e.$set(e.queryCondition,"username",t)},expression:"queryCondition.username"}}),t("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"info",plain:""},on:{click:function(t){return e.load(1)}}},[e._v("查询")]),t("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"warning",plain:""},on:{click:e.reset}},[e._v("重置")])],1),t("div",{staticClass:"operation"},["ADMIN"===e.user.roleName?t("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",plain:"",size:"default"},on:{click:e.handleAdd}},[e._v("新增用户")]):e._e(),t("el-button",{staticStyle:{height:"39.5px"},attrs:{size:"mini"}},[t("el-switch",{staticStyle:{"margin-left":"10px","font-size":"100px"},attrs:{"active-text":"可用"},on:{change:e.loadOrderStatus},model:{value:e.available,callback:function(t){e.available=t},expression:"available"}})],1)],1),t("div",{staticClass:"table"},[t("el-table",{attrs:{data:e.userData,stripe:""},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",idth:"55",align:"center"}}),t("el-table-column",{attrs:{prop:"userId",label:"序号",align:"center",sortable:""}}),t("el-table-column",{attrs:{label:"头像"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticStyle:{display:"flex","align-items":"center"}},[a.row.avatar?t("el-image",{staticStyle:{width:"40px",height:"40px","border-radius":"50%"},attrs:{src:a.row.avatar,"preview-src-list":[a.row.avatar]}}):e._e()],1)]}}])}),t("el-table-column",{attrs:{prop:"username",label:"用户名","show-overflow-tooltip":"",align:"center"}}),t("el-table-column",{attrs:{prop:"realName",label:"姓名","show-overflow-tooltip":"",align:"center"}}),t("el-table-column",{attrs:{prop:"email",label:"电子邮件","show-overflow-tooltip":"",align:"center"}}),t("el-table-column",{attrs:{prop:"phoneNumber",label:"电话",align:"center"}}),t("el-table-column",{attrs:{prop:"roleName",label:"角色",align:"center"}}),t("el-table-column",{attrs:{prop:"registrationDate",label:"注册时间",align:"center"}}),t("el-table-column",{attrs:{prop:"enableStatus",label:"启用状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return["1"===a.enableStatus?t("span",[e._v("已启用")]):(a.enableStatus,t("span",[e._v("未启用")]))]}}])}),t("el-table-column",{attrs:{label:"操作",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return["0"===a.row.enableStatus?t("el-button",{attrs:{plain:"",type:"primary",size:"mini"},on:{click:function(t){return e.handleEdit(a.row)}}},[e._v("启用")]):e._e(),"1"===a.row.enableStatus?t("el-button",{attrs:{plain:"",type:"danger",size:"mini"},on:{click:function(t){return e.handleEdit(a.row)}}},[e._v("停用")]):e._e()]}}])})],1),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{background:"","current-page":e.pageNum,"page-sizes":[1,10,20],"page-size":e.pageSize,layout:"total, prev, pager, next",total:e.total},on:{"current-change":e.handleCurrentChange}})],1)],1),t("el-dialog",{attrs:{title:"",name:"信息",visible:e.fromVisible,width:"40%","close-on-click-modal":!1,"destroy-on-close":""},on:{"update:visible":function(t){e.fromVisible=t}}},[t("el-form",{ref:"formRef",staticStyle:{"padding-right":"50px"},attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"头像"}},[t("div",[t("el-upload",{attrs:{"list-type":"picture-card",action:e.$baseUrl+"/files/upload","show-file-list":!1,"on-success":e.handleBookCoverSuccess}},[e.form.avatar?t("img",{staticClass:"avatar",staticStyle:{width:"148px",height:"148px"},attrs:{src:e.form.avatar}}):t("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)]),t("el-form-item",{attrs:{label:"用户名",prop:"username"}},[t("el-input",{attrs:{placeholder:"用户名"},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),t("el-form-item",{attrs:{label:"密码",prop:"password"}},[t("el-input",{attrs:{placeholder:"初始密码"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),t("el-form-item",{attrs:{label:"角色",prop:"roleId"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"true",placeholder:"请选择角色"},model:{value:e.form.roleId,callback:function(t){e.$set(e.form,"roleId",t)},expression:"form.roleId"}},[t("el-option",{attrs:{label:"管理员",value:"1"}}),t("el-option",{attrs:{label:"教师",value:"2"}}),t("el-option",{attrs:{label:"系主任",value:"3"}}),t("el-option",{attrs:{label:"教务处",value:"4"}})],1)],1),t("div",{staticStyle:{"text-align":"center","margin-bottom":"20px"}},[t("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("保 存")])],1)],1)],1)],1)},l=[],r={name:"User",data(){return{available:!1,tableData:[],categoryData:[],pageNum:1,pageSize:10,total:0,fromVisible:!1,currentUser:{},form:{},rules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],roleId:[{required:!0,message:"请选择角色",trigger:"blur"}]},user:JSON.parse(localStorage.getItem("xm-user")||"{}"),queryCondition:{username:null,enableStatus:null},textbookData:[],textbookIds:[],testData:["ni","ajh"]}},created(){this.load(1),this.loadUser(),this.selectCategory()},methods:{test(){this.$request.post("/user/test",this.testData).then((e=>{"200"===e.code?this.$message.success("没出错"):this.$message.error(e)}))},loadUser(){this.$request.get("/user/selectAll").then((e=>{"200"===e.code?this.tableData=e.data:this.$message.error(e,msg)}))},load(e){e&&(this.pageNum=e),this.$request.get("/user/selectPage",{params:{pageNum:this.pageNum,pageSize:this.pageSize,username:this.queryCondition.username,enableStatus:this.queryCondition.enableStatus}}).then((e=>{this.userData=e.data?.list,this.total=e.data?.total}))},loadOrderStatus(){!0===this.available?(this.queryCondition.enableStatus="1",this.load(1)):(this.queryCondition.enableStatus=null,this.load(1))},handleAdd(){this.form={},this.fromVisible=!0},handleEdit(e){this.$confirm("你确定当前的操作吗","确认操作",{type:"warning"}).then((t=>{this.currentUser=JSON.parse(JSON.stringify(e)),"1"===this.currentUser.enableStatus?this.currentUser.enableStatus="0":this.currentUser.enableStatus="1",this.$request.put("/user/setStatus",this.currentUser).then((e=>{"200"===e.code&&(this.$message.success("操作成功"),this.load(1),location.reload())}))})).catch((()=>{}))},order(e){"1"!==e.orderStatus?this.$message.error("暂不可征订"):this.$message.success("可以征订")},save(){this.$refs["formRef"].validate((e=>{e&&this.$request.post("/user/addUser",this.form).then((e=>{"200"===e.code?(this.$message.success("保存成功"),this.load(1),this.fromVisible=!1):this.$message.error(e.msg)}))}))},selectCategory(){this.$request.get("/category/selectAll").then((e=>{this.categoryData=e.data}))},del(e){this.$confirm("您确定删除吗？","确认删除",{type:"warning"}).then((t=>{this.$request.delete("/textbook/deleteById/"+e).then((e=>{"200"===e.code?(this.$message.success("删除成功"),this.load(1)):this.$message.error(e.msg)}))})).catch((()=>{this.load(1)}))},handleSelectionChange(e){this.textbookIds=e.map((e=>e.textbookId))},reset(){this.queryCondition.username=null,this.load(1)},handleCurrentChange(e){this.load(e)},handleBookCoverSuccess(e,t,a){this.form.bookCover=e.data}}},i=r,o=a(3736),n=(0,o.Z)(i,s,l,!1,null,"27cd8c07",null),u=n.exports}}]);
//# sourceMappingURL=9.5dab00f7.js.map